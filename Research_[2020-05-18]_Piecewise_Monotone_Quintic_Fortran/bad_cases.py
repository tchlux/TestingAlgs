
# This case causes the normal step procedure (without increasing the step)
# to require millions of steps. I had to change the procedure for this
# to work well.

import numpy as np
x = np.array([0.        , 0.00787402, 0.01574803, 0.02362205, 0.03149606,
       0.03937008, 0.04724409, 0.05511811, 0.06299213, 0.07086614,
       0.07874016, 0.08661417, 0.09448819, 0.1023622 , 0.11023622,
       0.11811024, 0.12598425, 0.13385827, 0.14173228, 0.1496063 ,
       0.15748031, 0.16535433, 0.17322835, 0.18110236, 0.18897638,
       0.19685039, 0.20472441, 0.21259843, 0.22047244, 0.22834646,
       0.23622047, 0.24409449, 0.2519685 , 0.25984252, 0.26771654,
       0.27559055, 0.28346457, 0.29133858, 0.2992126 , 0.30708661,
       0.31496063, 0.32283465, 0.33070866, 0.33858268, 0.34645669,
       0.35433071, 0.36220472, 0.37007874, 0.37795276, 0.38582677,
       0.39370079, 0.4015748 , 0.40944882, 0.41732283, 0.42519685,
       0.43307087, 0.44094488, 0.4488189 , 0.45669291, 0.46456693,
       0.47244094, 0.48031496, 0.48818898, 0.49606299, 0.50393701,
       0.51181102, 0.51968504, 0.52755906, 0.53543307, 0.54330709,
       0.5511811 , 0.55905512, 0.56692913, 0.57480315, 0.58267717,
       0.59055118, 0.5984252 , 0.60629921, 0.61417323, 0.62204724,
       0.62992126, 0.63779528, 0.64566929, 0.65354331, 0.66141732,
       0.66929134, 0.67716535, 0.68503937, 0.69291339, 0.7007874 ,
       0.70866142, 0.71653543, 0.72440945, 0.73228346, 0.74015748,
       0.7480315 , 0.75590551, 0.76377953, 0.77165354, 0.77952756,
       0.78740157, 0.79527559, 0.80314961, 0.81102362, 0.81889764,
       0.82677165, 0.83464567, 0.84251969, 0.8503937 , 0.85826772,
       0.86614173, 0.87401575, 0.88188976, 0.88976378, 0.8976378 ,
       0.90551181, 0.91338583, 0.92125984, 0.92913386, 0.93700787,
       0.94488189, 0.95275591, 0.96062992, 0.96850394, 0.97637795,
       0.98425197, 0.99212598, 1.        ])
y = np.array([0.84428838, 0.5316782 , 0.84361549, 0.3297786 , 0.35008627,
       0.70847721, 0.69155634, 0.1111936 , 0.30897958, 0.12869928,
       0.23326482, 0.37207053, 0.98028002, 0.37121875, 0.44711997,
       0.07639929, 0.37124655, 0.30264977, 0.36597435, 0.11852944,
       0.65689953, 0.07767499, 0.69625678, 0.23593911, 0.69682812,
       0.44850548, 0.96043262, 0.38980879, 0.81791332, 0.9391724 ,
       0.03734156, 0.59964689, 0.25986194, 0.2342354 , 0.51148883,
       0.94079873, 0.06192467, 0.95913663, 0.80659294, 0.90020791,
       0.05035693, 0.30073422, 0.12222783, 0.40154722, 0.17355181,
       0.06913691, 0.64696704, 0.53399559, 0.88195403, 0.1560406 ,
       0.34787674, 0.58272471, 0.08096962, 0.89225311, 0.96592443,
       0.53818353, 0.82791104, 0.49168403, 0.09566665, 0.40192077,
       0.52555024, 0.73233218, 0.13527872, 0.44023066, 0.6956519 ,
       0.63288769, 0.08403687, 0.33643686, 0.04784907, 0.14961727,
       0.20902615, 0.41518335, 0.50084075, 0.82288053, 0.77770131,
       0.49996437, 0.30945583, 0.13288597, 0.88337348, 0.45628047,
       0.61846899, 0.69548318, 0.74493713, 0.82341047, 0.49056902,
       0.43324822, 0.75290922, 0.36134999, 0.05458695, 0.81594529,
       0.65318025, 0.45910559, 0.98029373, 0.67619706, 0.13392473,
       0.35077372, 0.53499459, 0.79238128, 0.85235291, 0.59130891,
       0.0772845 , 0.37495994, 0.33805598, 0.88018508, 0.15353797,
       0.2635279 , 0.04728418, 0.46589816, 0.16144195, 0.97652471,
       0.43143275, 0.90590855, 0.20260423, 0.57158473, 0.74108906,
       0.79479433, 0.66552517, 0.99901986, 0.7162922 , 0.61176071,
       0.87479339, 0.71821783, 0.13031115, 0.76900987, 0.1506704 ,
       0.14867378, 0.29046   , 0.74657833])


# --------------------------------------------------------------------
#  Construct the monotone quintic spline interpolant.
# 
from monotone_quintic import monotone_quintic_spline
f = monotone_quintic_spline(x, y)

# --------------------------------------------------------------------
#  Plot the resultings monotone quintic spline interpolant.
# 
from util.plot import Plot
p = Plot()
p.add("points", x, y)
x = sum((list(np.linspace(x[i],x[i+1],10)) for i in range(len(x)-1)),[])
y = list(map(f,x))
p.add("Q", x, y, mode='lines')
p.show()
