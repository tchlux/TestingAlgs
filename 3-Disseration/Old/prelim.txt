Interpolation for Modeling<br>and Predicting Variability
Preliminary defense document
:: Thomas C.H. Lux :: tchlux@vt.edu :: http://people.cs.vt.edu/tchlux

# Table of Contents

1. @@The Importance and Applications of Variability@@
1. @@Naive Approximations of Variability@@
1. @@Scalable Interpolants for Approximation@@
1. @@Strong Approximations of Variability@@
1. @@An Error Bound on Piecewise Linear Interpolation@@
1. @@Improving Variability Estimates with Monotone $C^2$ Splines@@

# The Importance and Applications of Variability

# Naive Approximations of Variability

# Scalable Interpolants for Approximation

# Strong Approximations of Variability

# An Error Bound on Piecewise Linear Interpolation

# Improving Variability Estimates with Monotone $C^2$ Splines

This portion of the document proposes research on the numerically robust construction of monotone quintic interpolating splines from data that are $C^2$.

## Introduction and Motivation

Many domains of science rely on smooth approximations to real-valued functions over a closed interval. These smooth approximations are regularly used in automotive and aerospace engineering, architecture, mathematics and especially statistics [[knott2012interpolating]]. While polynomial interpolants or regressors apply broadly, piecewise polynomial functions (splines) are often a good choice because they can approximate globally complex functions while minimizing local complexity of the approximation. It is often the case that the true underlying function or phenomenon being modeled has known properties e.g., convexity, positivity, various levels of continuity, or monotonicity. Given a reasonably large amount of data, it can be impossible to maintain these properties with a single polynomial function.

In general, the maintenance of function properties through interpolation / regression is usually referred to as *shape preserving* [[fritsch1980monotone,gregory1985shape]]. The specific shapes this work will focus on are monotonicity and multiple levels of continuity for a function. These properties are chiefly important to the approximation of cumulative distribution functions and subsequently the effective generation of random numbers from a specified distribution. 

In statistics especially, the construction of a monotone interpolating spline that is continuous in second derivative is meaningfully useful [[ramsay1988monotone]]. A function with these properties could approximate random variables to a high level of accuracy with relatively few intervals((with even more accuracy given greater continuity)). A continuously twice differentiable approximation to a cumulative distribution function would also produce a corresponding probability density function that is continuously differentiable, which is a property many commonly occurring parametric distributions maintain.


## Related Work

The current state-of-the-art monotone interpolating spline with a mathematical software implementation is piecewise cubic, continuously differentiable, and was first proposed in [[fritsch1980monotone]] then expanded upon in [[carlson1985monotone]]. Let $\pi: a = x_1 < x_2 < \cdots < x_n = b$ be a partition of the interval $[a,b]$. Let $\{f(x_i) : i = 1,2,\ldots,n\}$ be a given set of data values at the partition points for a monotone function $f$, meaning $f(x_i) \leq f(x_{i+1})$ for $i = 1, \ldots, n-1$ or $f(x_i) \geq f(x_{i+1})$ for $i = 1, \ldots, n-1$. Let $\hat f$ be a piecewise cubic spline defined in each sub-interval $I_i = [x_i, x_{i+1}]$ by

$$ \begin{align}

h_i =& \ x_{i+1} - x_{i} \\
u(t) =& \ 3t^2 - 2t^3 \\
p(t) =& \ t^3 - t^2 \\
\hat f(x) =& \ f(x_i)\ u\big((x_{i+1} - x) / h_i\big) + f(x_{i+1})\ u\big((x - x_i) / h_i\big) \\
& - \hat f^{\ \prime}(x_i)\ p\big((x_{i+1}-x)/h_i\big) + \hat f^{\ \prime}(x_{i+1})\ p\big((x-x_i)/h_i \big).

\end{align} $$

Notice that it is up to the user to choose values for $\hat f^{\ \prime}$and a viable monotonic cubic spline can be produced by choosing $\hat f^{\ \prime}(x_i) = 0$, $i = 1, \ldots, n$. However, such a spline has too many *wiggles* for most applications. Fritsch and Carlson proceed to show that simple conditions on the derivative values can guarantee monotonicity, and that these conditions can be enforced in a way that ensures modifications on one interval will not break the monotonicity of cubic polynomials over any neighboring intervals. Consider the terms $\alpha = \frac{\hat f^{\ \prime}(x_i) (x_{i+1}-x_i)}{f(x_{i+1}) - f(x_i)}$ and $\beta = \frac{\hat f^{\ \prime}(x_{i+1}) (x_{i+1}-x_i)}{f(x_{i+1}) - f(x_i)}$, now monotonicity of a cubic polynomial over a sub-interval can be maintained by ensuring that $\alpha$ and $\beta$ reside in any of the following regions.

{{http://people.cs.vt.edu/tchlux/files/Dissertation/feasible_region.html}}

The actual region of monotonicity for a cubic polynomial is larger, but projection of $(\alpha, \beta)$ into one of these regions ensures that monotonicity will be achieved and not violated for neighboring regions. The user must decide which region is most suitable to project $(\alpha, \beta)$ onto, Fritsch and Carlson recommend using region 2.

This theoretical work has been extended in [[ulrich1994positivity,hess1994positive]] to monotone quintic polynomials, but no mathematical software has been produced accordingly. That is where this proposed work comes in.


## Achieved Progress

To expand my own understanding of the current state-of-the-art method for constructing a monotone spline interpolant, I {#37a}@{fully implemented}{https://github.com/tchlux/VarSys/blob/master/Disseration/cubic.py}@{#37a} the algorithm described in [[fritsch1980monotone]] in Python. This code can be used to generate monotone cubic spline fits to data and allows for the user specification of a method((the means by which monotonicity is enforced)) and derivatives at any of the knots or endpoints. Clearly this code is not optimized for numerical robustness, nor speed, but it serves as a portable demonstration and educational tool.

Here we can see the recommended method of projection for moving cubic polynomials into the region of monotonicity.

{{http://people.cs.vt.edu/tchlux/files/Dissertation/demo_projection.html}}

The resulting interpolating spline is $C^1$ and has a *smooth* appearance, here is a demonstration when using Region 2.

{{http://people.cs.vt.edu/tchlux/files/Dissertation/demo_fit.html}}

And the derivative of the above spline is continuous.

{{http://people.cs.vt.edu/tchlux/files/Dissertation/demo_fit_deriv.html}}

## Research Goal

{#3a7} ****Produce numerically robust software that computes monotone quintic interpolating splines given data.**** {#3a7}

## Timeline

|  |							|
| **Date**	 | **Milestone**						|
| *June<br>2019*	 | Implementation of monotone quintic polynomial *interpolant*. |
| *August<br>2019*	 | Implementation of monotone quintic polynomial *spline*.	|
| *October<br>2019* | First draft of TOMS paper on algorithm.			|
| *December<br>2019*| Research Defense of work.					|
| *March<br>2020*	 | Submission of TOMS paper and code.				|
| *April<br>2020*	 | Final Defense of Ph.D.					|

## Final Remarks

This project has the potential to be very widely utilized. As described earlier, many statistical applications could greatly benefit from having a $C^2$ approximation to CDFs, because the resulting PDF will be both aesthetically pleasing and more accurate for continuous distributions.

I spent last summer preparing a @{mathematical software}{https://github.com/tchlux/VarSys/blob/master/Code_[2018-06-11]_Stable_Arbitrary_Box_Splines/boxspline.f90}@ for the evaluation of box-splines, which may (or may not) be included in this package as well.


----------------------------------------------------------------------
# Important to Know
## General Matrix Operations
- QR 
- LU
- SVD 
- Diagonalization
## Under Special Conditions
- Spectral Decomposition for Symmetric
- Cholesky
- Shor Decomposition
----------------------------------------------------------------------


======================================================================


%% -------------------------------------------------------------------
%%                         Proposed New Work

@article{fritsch1980monotone,
  author = {Fritsch, F. and Carlson, R.},
  title = {Monotone Piecewise Cubic Interpolation},
  journal = {SIAM Journal on Numerical Analysis},
  volume = {17},
  number = {2},
  pages = {238-246},
  year = {1980},
  doi = { 10.1137/0717021 },
  URL = { https://doi.org/10.1137/0717021 },
  eprint = { https://doi.org/10.1137/0717021 },
}


@article{carlson1985monotone,
  author = {Carlson, R. and Fritsch, F.},
  title = {Monotone Piecewise Bicubic Interpolation},
  journal = {SIAM Journal on Numerical Analysis},
  volume = {22},
  number = {2},
  pages = {386-400},
  year = {1985},
  doi = {10.1137/0722023},
  URL = { https://doi.org/10.1137/0722023 },
  eprint = { https://doi.org/10.1137/0722023 },
}

@article{ramsay1988monotone,
  title={Monotone Regression Splines in Action},
  author={Ramsay, James O and others},
  journal={Statistical science},
  volume={3},
  number={4},
  pages={425--441},
  year={1988},
  publisher={Institute of Mathematical Statistics}
}

@article{gregory1985shape,
  title={Shape preserving spline interpolation},
  author={Gregory, John A},
  journal = {Brunel University},
  year={1985},
  url = { https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19850020252.pdf }
}

%% Dr. Watson's paper on monotone quintic spline interpolation.
@article{ulrich1994positivity,
  author = {Ulrich, G. and Watson, L.},
  title = {Positivity Conditions for Quartic Polynomials},
  journal = {SIAM Journal on Scientific Computing},
  volume = {15},
  number = {3},
  pages = {528-544},
  year = {1994},
  doi = { 10.1137/0915035 },
  URL = { https://doi.org/10.1137/0915035 },
  eprint = { https://doi.org/10.1137/0915035 },
}

%% A second paper published the same year as Dr. Watson's on quintic interpolation.
@article{hess1994positive,
  title={Positive quartic, monotone quintic C2-spline interpolation in one and two dimensions},
  author={Hess, Walter and Schmidt, Jochen W},
  journal={Journal of Computational and Applied Mathematics},
  volume={55},
  number={1},
  pages={51--67},
  year={1994},
  doi={ 10.1016/0377-0427(94)90184-8 },
  publisher={Elsevier}
}

%% Another paper on monotone quintics. This paper implements an algorithm for constructing a quintic interpolant.
@article{dougherty1989nonnegativity,
  title={Nonnegativity-, monotonicity-, or convexity-preserving cubic and quintic Hermite interpolation},
  author={Dougherty, Randall L and Edelman, Alan S and Hyman, James M},
  journal={Mathematics of Computation},
  volume={52},
  number={186},
  pages={471--494},
  year={1989}
}

@book{knott2012interpolating,
  title={Interpolating cubic splines},
  author={Knott, Gary D},
  volume={18},
  year={2012},
  doi = { 10.1007/978-1-4612-1320-8 },
  publisher={Springer Science \& Business Media}
}


