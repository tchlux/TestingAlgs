This version renames all variables from the direct Matlab
implementation and uses a little bit more proper fortran style. Still
needs some work cleaning up loops that copy points like rows.

Speedup over Matlab ~ 15.1x